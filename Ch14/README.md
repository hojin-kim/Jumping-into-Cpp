# 동적 메모리 할당

## 메모리 확보하기 : new
```cpp
int *p_int = new int;
```
`*p_int` 는 `new int` 를 통해서 정수형 크기의 메모리를 확보하게 된다. 이 메모리는 사용되다가 사용이 끝나면 반환되어야 한다. 포인터는 반환된 후에는 `NULL` 을 가르키도록 리셋하는 것이 좋다.
```cpp
delete p_int;
p_int = NULL;
```

### 메모리 부족
을방지하려면 할당한 메모리는 반드시 반환한다는 원칙을 지키시오

만일 메모리가 부족하다면 `new`를 호출할 때 실패하면서 예외를 발생시킨다.

### 레퍼런스와 동적 할당
할당한 메모리를 레퍼런스에 저장하면 안 된다...
```cpp
int &val = *(new int);
// 이러지 마시오
```
레퍼런스는 실제로는 메모리에 이름 하나를 더 주는 것이지 메모리 주소에 다이렉트로 접근할 수 있도록 하는 것이 아님!!

## 포인터와 배열
```cpp
int numbers[8];
int *p_numbers = numbers;

for (int i = 0; i <8; i++){
  p_numbers[i] = i;
}
cout << numebers[2];
// for 문 안에서  numbers[i] = i 가 실행된 것처럼
// 작동하기 때문에 2가 출력됨
```
배열은 포인터가 아니긴 한데 포인터에 대입할 수 있다.

이런 성질을 사용해서... 동적으로 메모리 배열을 할당하면 이렇게 된다.
```cpp
int  *p_numbers = new int[8];
```
이렇게 하면 `p_numbers` 포인터에 필요한 메모리 크기가 길이 8인 int 배열의 크기와 같게 할당이 됨. (동적)

나중에 이 포인터가 가르키는 메모리는 반환되어야 하며 다음과 같이 반환되면 된다.
```cpp
delete[] p_numbers;
```

